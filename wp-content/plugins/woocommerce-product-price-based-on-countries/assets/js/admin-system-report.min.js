jQuery(function(_){"use strict";var t={get_geo_var:function(e){var e="#wcpbc-"+e,r=!1;return r=void 0!==_(e).data("value")&&_(e).data("value")&&-1<(r=_(e).data("value")).indexOf(",")?r.split(",").shift().trim():r},isset_geo_country:function(){return t.get_geo_var("mm-country-code")||t.get_geo_var("http-cf-ipcountry")||t.get_geo_var("geoip-country-code")||t.get_geo_var("http-x-country-code")},x_forwarded_for_issue:function(){return!t.isset_geo_country()&&!t.get_geo_var("http-x-real-ip")&&t.get_geo_var("http-x-forwarded-for")&&t.get_geo_var("http-x-forwarded-for")!==t.get_geo_var("remote-addr")&&t.get_geo_var("real-external-ip")===t.get_geo_var("remote-addr")},get_first_ip_no_empty:function(){var r=!1;return["http-x-real-ip","http-x-forwarded-for","remote-addr"].forEach(function(e){e=t.get_geo_var(e);!1===r&&!1!==e&&(r=e)}),r},remote_addr_test:function(){var e=t.get_geo_var("real-external-ip");_.post(wc_price_based_country_admin_system_report_params.ajax_url,{action:"wc_price_based_country_remote_addr_check",security:wc_price_based_country_admin_system_report_params.remote_addr_check_nonce,external_ip:e},function(e){"1"==e.result?t.get_geo_var("use-remote-addr")?t.append_result("ok"):t.append_result("fail",wc_price_based_country_admin_system_report_params.define_constant_alert):t.append_result("fail")})},first_ip_test:function(){var e=t.get_geo_var("real-external-ip"),r=t.get_first_ip_no_empty();_.post(wc_price_based_country_admin_system_report_params.ajax_url,{action:"wc_price_based_country_remote_addr_check",security:wc_price_based_country_admin_system_report_params.remote_addr_check_nonce,external_ip:e,remote_addr:r},function(e){"1"==e.result?t.append_result("ok"):t.append_result("fail",wc_price_based_country_admin_system_report_params.ip_no_match)})},append_result:function(e,r){var t="";switch(r=void 0===r?"":r,e){case"ok":t='<mark class="yes"><span class="dashicons dashicons-yes"></span></mark>';break;case"fail":t='<mark class="error"><span class="dashicons dashicons-warning"></span>'+r+"</mark>"}_("#wcpbc-geolocation-test td.wcpbc-geolocation-test-result").html(t)},geolocation_test:function(){t.isset_geo_country()||"yes"===t.get_geo_var("geoipdb-exists")?t.x_forwarded_for_issue()?t.get_geo_var("remote-addr")!==t.get_geo_var("real-external-ip")||t.get_geo_var("use-remote-addr")?t.remote_addr_test():t.append_result("fail",wc_price_based_country_admin_system_report_params.define_constant_alert):t.isset_geo_country()||t.get_first_ip_no_empty()===t.get_geo_var("real-external-ip")?t.append_result("ok"):t.first_ip_test():t.append_result("fail",wc_price_based_country_admin_system_report_params.geoipdb_required)},init:function(){_("#wcpbc-geolocation-debug").on("wc_price_based_country_real_external_ip_loaded",function(){t.geolocation_test()})}};t.init()});