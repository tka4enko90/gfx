jQuery(function(_){"use strict";var a={get_geo_var:function(e){var r="#wcpbc-"+e,t=!1;return void 0!==_(r).data("value")&&_(r).data("value")&&-1<(t=_(r).data("value")).indexOf(",")&&(t=t.split(",").shift().trim()),t},isset_geo_country:function(){return a.get_geo_var("mm-country-code")||a.get_geo_var("http-cf-ipcountry")||a.get_geo_var("geoip-country-code")||a.get_geo_var("http-x-country-code")},x_forwarded_for_issue:function(){return!a.isset_geo_country()&&!a.get_geo_var("http-x-real-ip")&&a.get_geo_var("http-x-forwarded-for")&&a.get_geo_var("http-x-forwarded-for")!==a.get_geo_var("remote-addr")&&a.get_geo_var("real-external-ip")===a.get_geo_var("remote-addr")},get_first_ip_no_empty:function(){var t=!1;return["http-x-real-ip","http-x-forwarded-for","remote-addr"].forEach(function(e){var r=a.get_geo_var(e);!1===t&&!1!==r&&(t=r)}),t},remote_addr_test:function(){var e=a.get_geo_var("real-external-ip");_.post(wc_price_based_country_admin_system_report_params.ajax_url,{action:"wc_price_based_country_remote_addr_check",security:wc_price_based_country_admin_system_report_params.remote_addr_check_nonce,external_ip:e},function(e){"1"==e.result?a.get_geo_var("use-remote-addr")?a.append_result("ok"):a.append_result("fail",wc_price_based_country_admin_system_report_params.define_constant_alert):a.append_result("fail")})},first_ip_test:function(){var e=a.get_geo_var("real-external-ip"),r=a.get_first_ip_no_empty();_.post(wc_price_based_country_admin_system_report_params.ajax_url,{action:"wc_price_based_country_remote_addr_check",security:wc_price_based_country_admin_system_report_params.remote_addr_check_nonce,external_ip:e,remote_addr:r},function(e){"1"==e.result?a.append_result("ok"):a.append_result("fail",wc_price_based_country_admin_system_report_params.ip_no_match)})},append_result:function(e,r){var t="";switch(r=void 0===r?"":r,e){case"ok":t='<mark class="yes"><span class="dashicons dashicons-yes"></span></mark>';break;case"fail":t='<mark class="error"><span class="dashicons dashicons-warning"></span>'+r+"</mark>"}_("#wcpbc-geolocation-test td.wcpbc-geolocation-test-result").html(t)},geolocation_test:function(){a.isset_geo_country()||"yes"===a.get_geo_var("geoipdb-exists")?a.x_forwarded_for_issue()?a.get_geo_var("remote-addr")!==a.get_geo_var("real-external-ip")||a.get_geo_var("use-remote-addr")?a.remote_addr_test():a.append_result("fail",wc_price_based_country_admin_system_report_params.define_constant_alert):a.isset_geo_country()||a.get_first_ip_no_empty()===a.get_geo_var("real-external-ip")?a.append_result("ok"):a.first_ip_test():a.append_result("fail",wc_price_based_country_admin_system_report_params.geoipdb_required)},init:function(){_("#wcpbc-geolocation-debug").on("wc_price_based_country_real_external_ip_loaded",function(){a.geolocation_test()})}};a.init()});