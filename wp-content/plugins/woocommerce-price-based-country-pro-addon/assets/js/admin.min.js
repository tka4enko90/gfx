!function(s){"use strict";var _={init:function(){s(document.body).on("wc_price_based_country_manual_price_show",this.manual_price_show),s("select#product-type").on("change",this.show_and_hide_panels),s("input#_nyp").on("change",this.show_and_hide_panels),s("#woocommerce-product-data").on("change","input.variation_is_nyp",this.show_and_hide_variation_panels),s("#general_coupon_data #discount_type").on("change",this.coupon_type_change),s(document.body).ready(this.coupon_type_change),s("select.variation_actions").on("wcpbc_variable_bluck_edit_ajax_data",this.variable_bluck_edit),this.subscriptions_init(),this.bookings_init(),this.addons_init(),this.german_market_init(),this.germanized.init(),this.measurement_price_calculator.init()},show_and_hide_panels:function(){s(document.body).trigger("wc_price_based_country_show_and_hide_panels")},show_and_hide_variation_panels:function(){s(this).closest(".woocommerce_variation").find('.wcpbc_price_method[type="radio"][value="manual"]').each(function(){var e=s(this).prop("checked"),c=s(this).closest(".wcpbc_pricing");e&&_.manual_price_show(!1,c)})},manual_price_show:function(e,c){var i=s("select#product-type").val(),_=!c.find('.wcpbc_sale_price_dates[type="radio"][value="default"]').first().prop("checked"),o=wc_price_based_country_pro_admin_param.name_your_price_support&&s("input#_nyp").prop("checked"),a=wc_price_based_country_pro_admin_param.subscription_support&&("subscription"===i||"variable-subscription"===i);wc_price_based_country_pro_admin_param.name_your_price_support&&(c.closest(".woocommerce_variation").length&&(o=c.closest(".woocommerce_variation").find("input.variation_is_nyp").first().prop("checked")),c.find(".wcpbc_show_if_nyp").toggle(o),c.find(".wcpbc_show_if_manual").not(".wcpbc_show_if_nyp").toggle(!o),c.find(".wcpbc_show_if_manual.wcpbc_hide_if_sale_dates_default").not(".wcpbc_show_if_nyp").toggle(!o&&_),o?c.find(".wcpbc_input_subscription_price").prop("disabled",!0).css("background","#ccc"):c.find(".wcpbc_input_subscription_price").prop("disabled",!1).css("background","#fff")),wc_price_based_country_pro_admin_param.subscription_support&&(c.find(".wcpbc_show_if_manual_subscription").toggle(a),a&&c.find("._regular_price_wcpbc_field, ._variable_regular_price_wcpbc_field").hide(),c.find("._variable_sale_price_wcpbc_field").toggleClass("form-row-last",!a),c.find("._variable_sale_price_wcpbc_field").toggleClass("form-row-full",a))},coupon_type_change:function(){var e=s.inArray(s("#general_coupon_data #discount_type").val(),["percent","sign_up_fee_percent","recurring_percent"]);s("#general_coupon_data .options_group.wcpbc_pricing").toggle(e<0)},subscriptions_init:function(){wc_price_based_country_pro_admin_param.subscription_support&&(s(document.body).ready(this.move_subscriptions_fields),s(document.body).on("woocommerce_variations_added",this.move_subscriptions_fields),s("#woocommerce-product-data").on("woocommerce_variations_loaded",this.move_subscriptions_fields),s("#woocommerce-product-data").on("change",".wcpbc_pricing .wcpbc_input_subscription_price",function(){var e="#"+s(this).attr("id").replace("_subscription_price","_regular_price");s(e).val(s(this).val())}))},move_subscriptions_fields:function(){s("#woocommerce-product-data .wcpbc_show_if_manual_subscription").not("wcs_moved").each(function(){s(this).closest(".wcpbc_pricing").find("._variable_regular_price_wcpbc_field").before(s(this)),s(this).closest(".wcpbc_pricing").find("._regular_price_wcpbc_field").before(s(this)),s(this).addClass("wcs_moved")})},bookings_init:function(){s("#pricing_rows").on("change",".wc_booking_pricing_type select",function(e){void 0!==e.originalEvent&&_.booking_pricing_rows_change()}),s("#bookings_resources").on("change",".booking_resource_price_method",function(){var e="exchange_rate"==s(this).val()?"hidden":"visible";s(this).closest("tr").find(".booking_resource_cost").css("visibility",e)}),s("#bookings_persons").on("change",".booking_person_price_method",function(){var e="exchange_rate"==s(this).val()?"hidden":"visible";s(this).closest("tr").find(".booking_person_cost").css("visibility",e)}),s("li.wcpbc_bookings_pricing_options.wcpbc_bookings_pricing_tab.show_if_booking").insertAfter("li.bookings_pricing_options.bookings_pricing_tab.show_if_booking"),s("li.wcpbc_accommodation_bookings_rates_tab.show_if_accommodation-booking").insertAfter("li.accommodation_bookings_pricing_tab.show_if_accommodation-booking")},booking_pricing_rows_change:function(){s("#wcpbc_bookings_pricing .table_grid").hide(),s("#wcpbc_bookings_pricing .pricing_warning").show()},addons_init:function(){s("#wcpbc_product_addons_data select.wcpbc-price-method").on("change",function(){var e=s(this).closest("div.wcpbc-pao-addon"),c=s(this).val();e.toggleClass("closed","manual"!==c)}),s("#product_addons_data").on("change","select.wc-pao-addon-type-select, .wc-pao-addon-option-price-type, .wc-pao-addon-content-price input, .wc-pao-addon-adjust-price, .wc-pao-addon-adjust-price-select, .wc-pao-addon-adjust-price-value, .wc-pao-addon-min-max input",function(e){void 0===e.isTrigger&&(s("#wcpbc_product_addons_data .wc-metaboxes").hide(),s("#wcpbc-addons-update-required").show())})},german_market_init:function(){s('<div class="options_group"></div>').appendTo("#woocommerce-product-data #price_per_unit_options"),s("#woocommerce-product-data #price_per_unit_options p.form-field").appendTo("#woocommerce-product-data #price_per_unit_options .options_group"),s(".wcpbc_price_per_unit_options").appendTo("#woocommerce-product-data #price_per_unit_options")},germanized:{init:function(){s(document.body).on("woocommerce_variations_added",_.germanized.move_pricing_fields),s("#woocommerce-product-data").on("woocommerce_variations_loaded",_.germanized.move_pricing_fields),s(document.body).on("click","#_unit_price_auto",_.germanized.enable_disable_unit_price_fields),s(document).ready(function(){s("#general_product_data #_unit_price_auto").each(_.germanized.enable_disable_unit_price_fields)})},move_pricing_fields:function(){s(".woocommerce_variation.wc-metabox .variable_gzd_ts_labels").each(function(){s(this).closest(".woocommerce_variation.wc-metabox").find(".wcpbc_pricing").insertAfter(s(this))})},enable_disable_unit_price_fields:function(){s(this).is(":checked")?(s(this).closest("#general_product_data").find("._unit_price_regular_wcpbc_field input").attr("readonly","readonly"),s(this).closest("#general_product_data").find("._unit_price_sale_wcpbc_field input").attr("readonly","readonly"),_.germanized.auto_unit_price()):(s(this).closest("#general_product_data").find("._unit_price_regular_wcpbc_field input").removeAttr("readonly"),s(this).closest("#general_product_data").find("._unit_price_sale_wcpbc_field input").removeAttr("readonly"))},auto_unit_price:function(){var _=parseFloat(s("#_unit_product").val().replace(",",".")),o=parseFloat(s("#_unit_base").val().replace(",","."));isNaN(_)||isNaN(o)||s("#general_product_data ._unit_price_regular_wcpbc_field input, #general_product_data ._unit_price_sale_wcpbc_field input").each(function(){var e="#"+s(this).attr("id").replace("_unit_price","")+"_price",c=parseFloat(s(e).val().replace(",","."));if(isNaN(c))s(this).val("");else{var i=c/_*o;i=Math.round(100*i)/100,s(this).val(i.toString().replace(".",","))}})}},measurement_price_calculator:{init:function(){if(0<s("._wc_measurement_price_calculator_min_price_wcpbc_field").length){s(document.body).on("wc_price_based_country_manual_price_show",function(e,c){if(0<c.closest(".woocommerce_variation").length)var i=_.measurement_price_calculator.is_visible(c.closest(".woocommerce_variation").find(".show_if_pricing_calculator"))&&""!==s("#_measurement_price_calculator").val();else i=s("#_wc_measurement_price_calculator_min_price").is(":visible");c.find("._wc_measurement_price_calculator_min_price_wcpbc_field").toggle(i)});var e=jQuery("#_wc_measurement_price_calculator_min_price").closest(".show_if_pricing_calculator")[0];new MutationObserver(_.measurement_price_calculator.observerCallback).observe(e,{attributes:!0,childList:!1,subtree:!1})}},is_visible:function(e){return void 0===e.attr("style")||e.attr("style").indexOf("none")<0},observerCallback:function(e){s.each(e,function(e,c){if("style"===c.attributeName){var i=_.measurement_price_calculator.is_visible(s(c.target));return s("._wc_measurement_price_calculator_min_price_wcpbc_field").each(function(e,c){s(c).closest(".wcpbc_pricing").find('.wcpbc_price_method[type="radio"][value="manual"]').prop("checked")&&s(c).toggle(i)}),!1}})}},variable_bluck_edit:function(){var e,c={action:s("select.variation_actions option:selected").data("action"),zone_id:s("select.variation_actions option:selected").data("zone-id")};switch(c.action){case"regular_price_increase":case"regular_price_decrease":case"sale_price_increase":case"sale_price_decrease":null!=(e=window.prompt(wc_price_based_country_pro_admin_param.i18n_enter_a_value_fixed_or_percent))&&(0<=e.indexOf("%")?c.value=accounting.unformat(e.replace(/\%/,""),woocommerce_admin.mon_decimal_point)+"%":c.value=accounting.unformat(e,woocommerce_admin.mon_decimal_point));break;case"regular_price":case"sale_price":null!=(e=window.prompt(wc_price_based_country_pro_admin_param.i18n_enter_a_value))&&(c.value=e)}return c}},e={init:function(){s("#woocommerce_currency_pos").closest("tr").hide(),s(".wcpbc-zone-settings #exchange_rate").closest("tr").insertAfter(s('input[name="auto_exchange_rate"]').closest("tr")),s("#exchange_rate").closest("tr").toggle("no"==s('input[name="auto_exchange_rate"]:checked').val()),s("#exchange_rate_fee").closest("tr").toggle("yes"==s('input[name="auto_exchange_rate"]:checked').val()),s("#round_after_taxes").closest("tr").toggle(""!==s('select[name="round_nearest"]').val()),s('input[name="auto_exchange_rate"]').on("click",function(){s("#exchange_rate").closest("tr").toggle("no"==s(this).val()),s("#exchange_rate_fee").closest("tr").toggle("yes"==s(this).val())}),s('select[name="round_nearest"]').on("change",function(){s("#round_after_taxes").closest("tr").toggle(""!==s(this).val())}),0<s("#wc_price_based_currency_format_preview").length&&(s("#woocommerce_currency").addClass("wc_price_based_country_preview_currency"),s('.settings-panel.wcpbc-zone-settings select[name="currency"]').addClass("wc_price_based_country_preview_currency"),s("#wc_price_based_currency_format").addClass("wc_price_based_country_preview_format"),s("#woocommerce_price_num_decimals").addClass("wc_price_based_country_preview_num_decimals"),s("#woocommerce_price_decimal_sep").addClass("wc_price_based_country_preview_decimal_sep"),this.price_preview()),s(".wc_price_based_country_preview_currency, .wc_price_based_country_preview_format, .wc_price_based_country_preview_num_decimals, .wc_price_based_country_preview_decimal_sep").on("change",function(){e.price_preview()}),s("select#wc_price_based_country_exchange_rate_api").on("change",this.show_if_exchange_rate),this.show_if_exchange_rate()},price_preview:function(){var e=s(".wc_price_based_country_preview_currency:first option:selected").text(),c=s(".wc_price_based_country_preview_currency:first option:selected").val(),i=s(".wc_price_based_country_preview_format:first").val();i||(i=s("#wc_price_based_currency_format_preview").data("default"));var _=parseInt(s(".wc_price_based_country_preview_num_decimals:first").val()),o=s(".wc_price_based_country_preview_decimal_sep:first").val(),a="99"+(0<_?o:"")+"9".repeat(_),r=e.lastIndexOf("(");if(-1<r){e=e.substr(r+1).replace(")",""),i.indexOf("[price]")<0&&(i+="[price]");var n=void 0===wc_price_based_country_pro_admin_param.alt_currency_symbols[c]?e:wc_price_based_country_pro_admin_param.alt_currency_symbols[c],t=i.replace("[price]",a);t=(t=(t=t.replace("[code]",c)).replace("[symbol]",e)).replace("[symbol-alt]",n),s("#wc_price_based_currency_format_preview").html(t)}},show_if_exchange_rate:function(){var e=s("select#wc_price_based_country_exchange_rate_api").val();void 0!==e&&(s(".wcpbc_exchange_rate_option").closest("tr").hide(),s(".wcpbc_exchange_rate_option.show_if_exchange_rate_"+e).closest("tr").show())}};_.init(),e.init()}(jQuery);