!function(t){"use strict";var o={rule_row_template:null,init:function(){this.rule_row_template=wp.template("wcpbc-pricing-rule-row"),this.pricing_rule_rows(),t(document).ready(function(){t("#woocommerce-pricing-rules-wrap").on("click",".delete_pricing_rule, .delete_pricing_blockrule",o.on_delete_pricing_rule_click),t("#woocommerce-pricing-rules-wrap").on("click",".add_pricing_rule, .add_pricing_blockrule",o.on_add_pricing_rule_click),t("#woocommerce-pricing-rules-wrap").on("change",'tr td select[name$="[type]"]',function(){o.show_hide_pricing_rows(this)}),t("#woocommerce-pricing-rules-wrap").on("change",".wcpbc_pricing_rules_price_method",function(){o.disable_pricing_zone_amount(this)}),t("#woocommerce-pricing-category form").append('<input type="hidden" name="wcpbc-advanced-category-nonce" value="'+wc_price_based_country_pro_dynamic_pricing_params.security+'" />')}),t(document).ajaxComplete(this.on_add_ruleset)},pricing_rule_rows:function(){t('div.woocommerce_pricing_ruleset tr[id^="pricing_rule_row_set"], div.woocommerce_pricing_ruleset tr[id^="pricing_blockrule_row_set"]').not(".wcpbc_pricing_rules_rows_added").each(function(){o.add_rule_rows(this)}),t('#woocommerce-pricing-rules-wrap tr td select[name$="[type]"]').each(function(){o.show_hide_pricing_rows(this)})},get_row_properties:function(e){var e=t(e).attr("id").split("_row_set_"),i=e[1].lastIndexOf("_"),r={};return r.mode=e[0].replace("pricing_",""),r.id="set_"+e[1].substr(0,i),r.index=e[1].substr(i+1),r},add_rule_rows:function(e){var r,_,c,n=o.get_row_properties(e);wc_price_based_country_pro_dynamic_pricing_params.zones.forEach(function(i){c=o.rule_row_template({rule_id:n.id,rule_mode:n.mode,index:n.index,zone_id:i.zone_id,label:i.label}),t(e).after(c),t(e).addClass("wcpbc_pricing_rules_rows_added"),r=i.pricing_rules,["price_method","amount"].forEach(function(e){_="#wcpbc_pricing_rules_"+i.zone_id+"_"+n.id+"_"+n.mode+"s_"+n.index+"_"+e,void 0!==r[n.id]&&void 0!==r[n.id][n.mode+"s"]&&void 0!==r[n.id][n.mode+"s"][n.index]&&void 0!==r[n.id][n.mode+"s"][n.index][e]&&t(_).val(r[n.id][n.mode+"s"][n.index][e]),"price_method"===e&&o.disable_pricing_zone_amount(_)})})},show_hide_pricing_rows:function(e){var i=t(e).val(),e=".wcpbc_"+t(e).closest("tr").attr("id");t(e).toggle("percentage_discount"!==i&&"percent_adjustment"!==i)},disable_pricing_zone_amount:function(e){var i="#"+t(e).attr("id").replace("_price_method","_amount");t(i).toggle("exchange_rate"!==t(e).val())},on_delete_pricing_rule_click:function(){var e=t(this).data("name"),i=t(this).data("index"),r="pricing_"+t(this).attr("class").split("_")[2]+"_row_"+e+"_"+i;0==t("#"+r).length&&wc_price_based_country_pro_dynamic_pricing_params.zones.forEach(function(e){t("#"+e.zone_id+"_"+r).remove()})},on_add_pricing_rule_click:function(){var e=t(this).data("name"),i=t(this).data("index"),e="pricing_"+t(this).attr("class").split("_")[2]+"_row_"+e+"_",r="#"+e+t(this).closest("table").data("lastindex"),e=".wcpbc_"+e+i;t(r).insertAfter(t(e).last()),o.add_rule_rows(r)},on_add_ruleset:function(e,i,r){void 0!==r.data&&(-1<r.data.indexOf("action=create_empty_ruleset")||-1<r.data.indexOf("create_empty_category_ruleset"))&&o.pricing_rule_rows()}};o.init()}(jQuery);